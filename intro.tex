\section{Introduction}

%Intro
In order to make Autonomous Vehicles (AV) reliable in a real-world scenario, safety for every agent involved must be the focus of every self-driving system implementation.
This objective will be achieved once the AV has a clear understanding of the driving scene around it, focusing on the main visual cues that are needed for its correct behaviour, differentiating between normal and anomalous situations, so that it can react in real-time to make the safest decision.
It is necessary to track down all possible causes for the sake of accident avoidance, this must be done with both precision and promptness to assure the maximum reaction space.

%Task
Our work put the focus on video analysis captured by dash-mounted cameras, willing to improve the tools for driving scene interpretation in the context of Advanced Driver Assistance Systems (ADAS).
From this perspective, a driving scenario is quite hard to model since there are many information to take into account that can be exploited to define the driving scene.
There are plenty of possible accident classes that must be taken into account and to make matters worse, most of the times, it is quite hard to distinguish normal driving scenes from accident ones at frame level, which further enhances the problem's complexity.

%Anomaly
Though we know that accidents are a consequence of an anomalous driving scenario, it is non-trivial to define precise boundaries of what a driving anomaly is.
We can define an anomaly as an hazardous situation that can lead to an accident, but since the hazardousness prior to the accident may be determined subjectively by each individual, the time interval edges for an anomaly are not really clear and this is reflected in some dataset annotations.
Some attempts have been made to propose a deterministic method in the interest of defining an anomaly.
Yao et al. \cite{yao2019unsupervised} defines an anomaly as the window in which the accident happens, but since we want to prevent it, this might not be ideal in a prevention perspective.
Fang et al. \cite{fang2019dada} instead want to predict an accident willing to happen in the next 5 seconds labelling the anomaly start from the moment in which half part of the object involved in the accident appears in the view.
Yao et al. \cite{yao2020when} proposed a Detection of Traffic Anomaly (DoTA) dataset that takes into account When the anomalous event starts and ends, locates spatially Where all the involved agents are in each frame and What type of anomaly it is.
Their work formulates the anomaly start as the instant after which the accident is unavoidable.
As said before choosing that instant is quite subjective depending on the situation and personal biases, in fact Lung et al. \cite{lund2009riskperception} argues that risk perception is related to social constructs that reflect the cultural context in which people live in.

%TODO Saliency
%Determining an anomalous scene implies to evaluate the salient regions
Human's capability of evaluating danger on the fly is still a matter of study by neuroscientists.
When comparing machine to humans in the task of describing the content of an image we know that the latters perform better \cite{jiang2015salicon}.
Since we are aiming to develop a system capable of estimating danger in traffic video scenes it is worth emulating how humans focus on important regions or objects in images through saliency estimation.
The commonly adopted saliency definition is based on how pixels/regions stand out and is dependent of what kind of visual stimuli human respond to the most \cite{yan2013hierachical}.
Cornia et al.\cite{cornia2016saliency} proposed Multi-Level Network for Saliency Prediction (MLNET), an architecture for saliency estimation which simulates what human see at first glance, a step forward towards driving scene comprehension.

%TODO Breve accenno su tranformer
Transformer have become the most popular approach in computer vision tasks, dominating over CNN architectures, after the introduction of Vision Transformer (Dosovitskiy et al. \cite{DBLP:conf/iclr/DosovitskiyB0WZ21})  with which image patches are seen as tokens (word) in NLP applications, while keeping the architecture as similar as possible to the original.
A meaningful upgrade to this architecture, proposed by Liu et al. \cite{liu2021Swin}, was Swin Transformer.
Comparing to the previous architecture, the latter keeps a linear computational complexity to image size and builds hierarchical feature maps by using a shifting window mechanism on the window partition between consecutive self-attention layers, allowing for a significant enhance in modelling power while keeping efficiency in latency regards.
As a further proof, Video Swin Transfomer \cite{liu_video_2022} surpassed previous convolutional models for video recognition tasks by taking advantage of spatio-temporal locality of videos, that is, pixel that are closer to each other in spatio-temporal distance are more likely to be correlated.\\

%Contribution
Following the satisfying result of the previous works we propose to solve the problem of traffic anomaly detection in videos by using a Video Swin Transformer as our backbone network, adapting it to work in a real-time scenario, as expected from an ADAS implementation.
As a further contribution for our work we introduced a saliency map estimation model for each frame by using an MLNET, willing to let the model focus only on the most pertinent regions of the traffic scenes.
Finally we propose a relabelling of DoTA dataset adopting a different criterion of evaluation disentangled from the subjectivity and granting a deterministic method for estimating anomaly boundaries, allowing the largest possible reaction space while maintaining normal and anomalous scenes well separated.

In the next sections we will first introduce all the previous work at the state-of-the-art that led us into building the novel architecture we are presenting, it will follow an overview of mathematical representation of our work and an in-depth explanation of all the components emploied. 
Finally we will present an ablation study where we will prove the superiority of our method compared to the state-of-the-art at the time